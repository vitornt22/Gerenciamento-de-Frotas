{% extends 'BaseItems/base.html' %}
{% load crispy_forms_tags %}
{% load static %}
{% block links %}
{% endblock links %}

{%block preLoader%}
<!-- Preloader -->
{%if load is True%}
<!--
<div class="preloader flex-column justify-content-center align-items-center">
    <img class="animation__shake" src="{%static 'dist/img/icone.png' %}" alt="Optar Locações" height="200" width="200">
</div>
-->
{%endif%}
{%endblock preLoader%}
  

{%block listar%}
<li class="nav-item">
<a name="" class="nav-link"  href="{%url 'vehicle:one' %}" data-toggle="tooltip"
data-placement="top" title="Listar Veículos">
    <i class="fa-solid fa-list"></i>
</a>
</li>

<li class="nav-item">
    <a class="nav-link"  href="{%url 'vehicle:regVehicle' %}" data-toggle="tooltip"
    data-placement="top" title="Cadastrar Novo Veiculo">
        <!--Botao Sair-->
        <i class="fa-solid fa-truck-medical"></i>
    </a>
</li>

{%endblock listar%}

{% block pesquisa %}
    {% load static %}
    <div class="pesquisaForm">
        <form method="POST" style="" class="d-flex" role="search">
            {% csrf_token %}
            <!--name="search_vehicles"-->
            {% include 'includeItems/barraPesquisa.html' %}
        </form>
    </div>
{% endblock %}
{% block opcoes %}
    {%include 'includeItems/VehicleOption.html' %}
{% endblock opcoes %}
{% block content %}
    <div clas="row">
        {% if tabela is None %}
            <div style="width:95%;" class=" shadow-sm  card  h6 text-danger align-items-center">
                <p class="mt-3">Busca Inválida: Não há Veiculos: <a href="{%url 'vehicle:one' %}">Listar Veículos</a></p>
            </div>
            <br>
        {% endif %}
        {% if resultados %}
            
            <div style="width:95%;" class=" shadow-sm  card  h6 text-success align-items-center">
                <p class="mt-3">Resultados para: {{ resultados }}</p>
            </div>
            
            <br>
        {% endif %}
        {% if number == 0 %}
            <div style="width:95%;" class=" shadow-sm  card  h6 text-danger align-items-center">
                <p class="mt-3">Não há veiculos cadastrados<a href="{%url 'vehicle:regVehicle' %}">: clique aqui para cadastrar novo veículo!</a></p>
            </div>
            <br>
        {% endif %}

        <div class="row">
    
            
            {%for vehicle in tabela%}
            <a role="button" href="{%url 'vehicle:profile' vehicle.slug %}">
            <div class="col-12 col-lg-6  col-xl-4 col-sm-12  col-md-6 d-flex align-items-stretch flex-column">
              <div class="card bg-light d-flex flex-fill">
                <div class="card-header text-muted border-bottom-0">
                </div>
                <div class="card-body pt-0">
                  <div class="row">
                    <div class="col-7">
                      <h2 class="lead"><b>{{vehicle.vehicle_type}}</b></h2>
                      <p class="text-muted text-sm"><b>Marca: </b> {{vehicle.brand}}  /<b>Ano: </b> {{vehicle.year}} /  <b>Modelo: </b> / {{vehicle.vehicle_model}} /  </p>

                      <ul class="ml-4 mb-0 fa-ul text-muted">
                        <li class="small"><span class="fa-li"><i class="fa-solid fa-truck"></i></span> <b>Placa</b>:  {{vehicle.license_plate}}</li>
                        <li class="small"><span class="fa-li"><i class="fa-solid fa-truck"></i></span> <b>Chassi</b> : {{vehicle.chassi}} </li>
                      </ul>
                    </div>
                    <div class="col-5 text-center">
                      <img src="{%static 'dist/img/truck.jpg' %}" alt="user-avatar" class="img-circle img-fluid">
                    </div>
                  </div>
                </div>
                <div class=" card-footer">
                
                  <div class="text-right">
                    <a href="#" class="btn ">
                        <div class = "list-items" style="text-align: center;">
                            <a style="font-size: 0.8rem;" name="edit"
                               href="{% url 'vehicle:edit' vehicle.slug %}"
                               class="btn btn-primary">Editar <i class="fa-regular fa-pen-to-square"></i>
                            </a>
                            <a style="font-size: 0.8rem;" name="removeButton"
                                    href="{%url 'vehicle:removeAll' vehicle.slug%}"
                                    value="{{ vehicle.chassi }}"
                                    id="removeButton"
                                    class="areSure btn btn-danger">
                                Remover <i class="fa-regular fa-trash-can"></i>
                            </a>
                            {% if vehicle.it_location %}
                                <button style="font-size: 0.7rem;" 
                                        disabled
                                        class="btn btn-secondary">Locado! <i class="fa-solid fa-lock"></i></button>
                            {% else %}
                                <a style="font-size: 0.8rem;" 
                                   href="{% url 'location:locar' vehicle.slug profile %}"
                                   class="btn btn-success">Locar <i class="fa-regular fa-circle-check"></i></a>
                            {% endif %}
                        </div>
                    </a>

                  </div>
                </div>
              </div>
            </div>
            </a>
            {%endfor%}
            
        
    </div>
</div>

{% endblock content %}
{% block  scriptAdd %}
    
   
    <script >
        $(document).on('click', '.areSure', function(e){
            var form = document.getElementById("form-this")
            return confirm("Tem certeza que quer deletar ?")
        });

        {% for msg in messages%}
        {% if msg.tags == "message-sucess" %}
        var icon="success";
        {% elif msg.tags == "message-error" %}
        var icon="error"
        {%else%}
        var icon='warning'
        {%endif%}
        swal({
        title: "{{msg}}",
        icon: icon,
        timer: 3000,
        button: "ok"}).then((value) => {
            window.location="{%url 'vehicle:one'%}";
        });
        

        {% endfor %}
      
    </script>
{% endblock scriptAdd %}
